from data_sources import MongoHotelInnstant, TravelyoMaster, BookingCom
from hotel_dataset import Hotel

if __name__ == "__main__":
    hotel_ids = ['5300384', '4376908', '4027039', '4026885', '4026503', '4026420', '4027005', '4026590', '12083128',
                 '12687943', '12865828', '5926868', '4026870', '6636022', '12201641', '10884824', '4027521', '4026500', '4027603', '4377249', '4027066', '4028141', '4377230', '4376893', '4027264', '4028858', '4027166', '4027526', '4558760', '4027531', '4026427', '8347135', '5146613', '4026473', '10276727', '4027336', '4026390', '4027602', '4027517', '6018056', '15933228', '4027469', '4027037', '4377311', '4027212', '4029032', '4026554', '4028325', '9227794', '6821666', '4026418', '4027060', '4027486', '4026431', '4027071', '4027276', '4490985', '4026406', '4376844', '4026376', '4027992', '4027072', '4027533', '4026754', '4027312', '4376871', '4028323', '4027784', '4026792', '4026379', '9397553', '4027525', '5942222', '4026821', '4027139', '4026435', '11159982', '4376916', '4376867', '4026727', '4026505', '4027344', '4377300', '10276718', '4026449', '6417628', '4026588', '4203515', '10059833', '4203638', '4203354', '4203405', '4203774', '4203400', '4203325', '6435718', '8312874', '4460390', '4203401', '4203634', '4203327', '4203491', '6563826', '4203733', '4203756', '4203460', '6693691', '4203838', '4203458', '4203359', '6399905', '4203680', '6503289', '14517025', '4203760', '14517026', '4203913', '4931042', '4203847', '4330485', '4460547', '4463508', '4203531', '4462448', '6915571', '4203368', '4203476', '4203472', '4203509', '4460379', '4496268', '4203432', '4203427', '4203533', '4928927', '12284351', '4203374', '4203431', '6255507', '4203712', '4203461', '6851488', '4203652', '4203551', '4203377', '4203579', '4203661', '4203508', '4203560', '6674547', '4203789', '4639380', '4203469', '4203516', '4203465', '4203528', '4203496', '6456590', '4203452', '4203474', '4203423', '4496269', '4203513', '4203421', '4203484', '8692293', '4203447', '5913413', '4203717', '9426572', '4203398', '4203457', '12112020', '6748108', '4203505', '4203351', '4475080', '4203644', '6207339', '4203382', '4203438', '4203575', '12252958', '4203524', '4203393', '4482358', '6368699', '6668849', '5779011', '6703456', '9266562', '4020987', '6509970', '9211082', '4020977', '10943051', '8313231', '8344063', '5744421', '6959661', '4326974', '4477005', '6475950', '5840382', '6378029', '6861237', '7122369', '12620061', '6820550', '6801296', '6868818', '4021079', '4306038', '15398467', '12924976', '4020954', '6266999', '4306221', '12798899', '7098596', '4077879', '6846794', '8600357', '5158675', '5779026', '9192821', '11677066', '9177098', '4020950', '6264537', '6395743', '4742006', '4640269', '11027826', '11812969', '6512109', '10645639', '6389432', '10918959', '11103889', '10645638', '9590933', '8313230', '11103929', '6419919', '9266662', '4306039', '4326959', '7151434', '10991048', '12463907', '4021330', '5658478', '11739460', '6222176', '11812967', '4206733', '6391744', '6926535', '10878691', '4206738', '11053648', '9216382', '11750320', '12919590', '9177141', '4206755', '4206723', '12094828', '4206716', '4815637', '10931085', '10761714', '14008887', '12262600', '4206711', '4337655', '4206717', '12400377', '4206714', '5657367', '4206797', '4206719', '9192823', '6010907', '11092662', '4206783', '10800538', '4337679', '4206763', '15543034', '15723446', '14845466', '6774501', '4206753', '4206756', '10800572', '9216415', '14845464', '4206731']
    hotels_objs = Hotel.build_objs(hotel_ids=hotel_ids)
    mongo_hotel_innstant_objs = MongoHotelInnstant.pull_data(hotel_ids=hotel_ids)
    booking_com_objs = BookingCom.pull_data(hotel_ids=hotel_ids)
    # travelyo_master_objs = TravelyoMaster.pull_data(hotel_ids=hotel_ids)

    for htl in hotels_objs:
        htl.update_mongo_data(
            obj=MongoHotelInnstant.get_hotel_by_id(
                hotel_id=htl.hotel_id, objs=mongo_hotel_innstant_objs
            )
        )
        htl.update_booking_com_data(
            obj=BookingCom.get_hotel_by_id(hotel_id=htl.hotel_id, objs=booking_com_objs)
        )
        if htl.check_all_attrs():
            htl.insert_mongo()
